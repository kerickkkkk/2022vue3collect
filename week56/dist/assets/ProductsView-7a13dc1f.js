import{s as C,h as G,u as j,j as B,k as L,l as V,i as N,r as D,m as F,o,c,b as s,F as y,n as R,p as a,q as T,t as g,x as d,d as m,g as U}from"./index-907ac9d8.js";import{_ as q}from"./PaginationComponent-7c543ffc.js";function A(e=1){return C({method:"get",url:`/products?page=${e}`})}const E=G("products",{state:()=>({products:[],pagination:[]}),getters:{productsGetter:({products:e})=>e,paginationGetter:({pagination:e})=>e},actions:{async getProducts(e=1){var l;try{if(e===((l=this.pagination.value)==null?void 0:l.current_page))return!1;const{products:r,pagination:u}=await A(e);this.products=r,this.pagination=u}catch(r){console.log(r)}}}}),M={class:"container"},z=s("h3",{class:"text-center my-4"},"產品",-1),H={class:"row"},I={class:"card h-100"},J=["src"],K={class:"card-body"},O={class:"d-flex justify-content-between"},Q={class:"card-title"},W={class:"badge rounded-pill bg-secondary h5"},X={class:"d-flex justify-content-between"},Y={key:0,class:"h5 ms-auto"},Z={class:"text-danger h5 ms-auto"},tt={class:"d-flex justify-content-center"},st=["onClick"],et={key:0,class:"spinner-grow spinner-grow-sm",role:"status","aria-hidden":"true"},ot=["onClick"],at={key:0,class:"spinner-grow spinner-grow-sm",role:"status","aria-hidden":"true"},rt={__name:"ProductsView",setup(e){const l=j(),r=B(),u=L(),h=E(),{addCart:b}=u,{getProducts:f}=h,{productsGetter:k,paginationGetter:i}=V(h),{setLoading:p}=r,x=N("$swal"),w="https://vue3-course-api.hexschool.io/v2",$="vue3",v=D(!1),P=_=>{p(!0),U.get(`${w}/api/${$}/product/${_}`).then(({data:n})=>{n.success&&l.push({name:"product",params:{id:_}}),p(!1)}).catch(n=>{var t;p(!1),console.dir(n),x((t=n==null?void 0:n.response)==null?void 0:t.data)})};return F(()=>{f()}),(_,n)=>(o(),c("div",M,[z,s("div",H,[(o(!0),c(y,null,R(a(k),t=>(o(),c("div",{class:"col-md-4 mb-3",key:t.id},[s("div",I,[s("img",{src:t.imageUrl,class:"card-img-top",alt:"圖片"},null,8,J),s("div",K,[s("div",O,[s("h5",Q,d(t.title),1),s("div",null,[s("div",W,d(t.category),1)])]),s("div",X,[t.origin_price===t.price?(o(),c("span",Y,"$"+d(t.origin_price),1)):(o(),c(y,{key:1},[s("del",null,"$"+d(t.origin_price),1),s("span",Z,"$"+d(t.price),1)],64))]),s("div",tt,[s("button",{onClick:S=>P(t.id),class:"btn btn-outline-primary me-3",type:"button"},[v.value.itemLoading===t.id?(o(),c("span",et)):g("",!0),m(" 看詳細 ")],8,st),s("button",{onClick:S=>a(b)(t.id,1),class:"btn btn-danger",type:"button"},[v.value.itemLoading===t.id?(o(),c("span",at)):g("",!0),m(" 加入購物車 ")],8,ot)])])])]))),128))]),a(i)?(o(),T(q,{key:0,current_page:a(i).current_page,total_pages:a(i).total_pages,has_next:a(i).has_next,has_pre:a(i).has_pre,onGetPage:a(f)},null,8,["current_page","total_pages","has_next","has_pre","onGetPage"])):g("",!0)]))}};export{rt as default};
