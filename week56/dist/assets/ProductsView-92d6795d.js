import{s as C,h as G,u as j,j as B,k as L,l as V,i as N,r as U,m as D,o,c,b as s,F as y,n as F,p as a,q as R,t as h,x as d,d as b,g as T}from"./index-b26f5b11.js";import{_ as q}from"./PaginationComponent-e6b2cc9f.js";const A="https://vue3-course-api.hexschool.io/v2",E="vue3";function M(e=1){return C({method:"get",url:`${A}/api/${E}/products?page=${e}`})}const z=G("products",{state:()=>({products:[],pagination:[]}),getters:{productsGetter:({products:e})=>e,paginationGetter:({pagination:e})=>e},actions:{async getProducts(e=1){var u;try{if(e===((u=this.pagination.value)==null?void 0:u.current_page))return!1;const{products:r,pagination:l}=await M(e);this.products=r,this.pagination=l}catch(r){console.log(r)}}}}),H={class:"container"},I=s("h3",{class:"text-center my-4"},"產品",-1),J={class:"row"},K={class:"card h-100"},O=["src"],Q={class:"card-body"},W={class:"d-flex justify-content-between"},X={class:"card-title"},Y={class:"badge rounded-pill bg-secondary h5"},Z={class:"d-flex justify-content-between"},tt={key:0,class:"h5 ms-auto"},st={class:"text-danger h5 ms-auto"},et={class:"d-flex justify-content-center"},ot=["onClick"],at={key:0,class:"spinner-grow spinner-grow-sm",role:"status","aria-hidden":"true"},nt=["onClick"],ct={key:0,class:"spinner-grow spinner-grow-sm",role:"status","aria-hidden":"true"},dt={__name:"ProductsView",setup(e){const u=j(),r=B(),l=L(),g=z(),{addCart:m}=l,{getProducts:f}=g,{productsGetter:k,paginationGetter:i}=V(g),{setLoading:p}=r,x=N("$swal"),$="https://vue3-course-api.hexschool.io/v2",w="vue3",v=U(!1),P=_=>{p(!0),T.get(`${$}/api/${w}/product/${_}`).then(({data:n})=>{n.success&&u.push({name:"product",params:{id:_}}),p(!1)}).catch(n=>{var t;p(!1),console.dir(n),x((t=n==null?void 0:n.response)==null?void 0:t.data)})};return D(()=>{f()}),(_,n)=>(o(),c("div",H,[I,s("div",J,[(o(!0),c(y,null,F(a(k),t=>(o(),c("div",{class:"col-md-4 mb-3",key:t.id},[s("div",K,[s("img",{src:t.imageUrl,class:"card-img-top",alt:"圖片"},null,8,O),s("div",Q,[s("div",W,[s("h5",X,d(t.title),1),s("div",null,[s("div",Y,d(t.category),1)])]),s("div",Z,[t.origin_price===t.price?(o(),c("span",tt,"$"+d(t.origin_price),1)):(o(),c(y,{key:1},[s("del",null,"$"+d(t.origin_price),1),s("span",st,"$"+d(t.price),1)],64))]),s("div",et,[s("button",{onClick:S=>P(t.id),class:"btn btn-outline-primary me-3",type:"button"},[v.value.itemLoading===t.id?(o(),c("span",at)):h("",!0),b(" 看詳細 ")],8,ot),s("button",{onClick:S=>a(m)(t.id,1),class:"btn btn-danger",type:"button"},[v.value.itemLoading===t.id?(o(),c("span",ct)):h("",!0),b(" 加入購物車 ")],8,nt)])])])]))),128))]),a(i)?(o(),R(q,{key:0,current_page:a(i).current_page,total_pages:a(i).total_pages,has_next:a(i).has_next,has_pre:a(i).has_pre,onGetPage:a(f)},null,8,["current_page","total_pages","has_next","has_pre","onGetPage"])):h("",!0)]))}};export{dt as default};
